
    <!-- Content Header (Page header) -->
    <style>
    .error{
      color: red;
    }
  </style>
    <div ng-app="addpcmh">
    <section class="content-header" >
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Update PCMH</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Update PCMH</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <div id="loader" style="display: none;"></div>
        <div class="row">
          <!-- left column -->
          <div class="col-md-12">
            <!-- general form elements -->
            <div class="card card-primary" >
              <div class="card-header" style="background-color: #048db7 !important;">
                <h3 class="card-title">Update PCMH</h3>
                
              </div>
              <!-- /.card-header -->
              <!-- form start -->
              <form role="form" name="form" id="form" enctype="multipart/form-data" ng-controller="addpcmhController" ng-submit="submitForm()">
                <input type="hidden" name="pcmhid" id="pcmhid"  value="" class="form-control" placeholder="PCMH Name">
                        
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                     <div class="form-group">
                        <label>PCMH Name <span style="color:red;">*</span> <small>(example Coastal Hospitals)</small></label>
                        <input type="text" name="pcmh_name" id="pcmh_name"  value="" class="form-control" placeholder="PCMH Name" ng-model="pcmh.pcmh_name" required>
                        <span class="error" ng-show="form.pcmh_name.$dirty && form.pcmh_name.$error.required">Enter Your PCMH Name!.</span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>PCMH Site Name <small>(example Coastal East RI)</small></label>
                        <input type="text" name="pcmh_site_name" id="pcmh_site_name"  class="form-control" placeholder="PCMH Site Name" ng-model="pcmh.pcmh_site_name">
                       
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-6">
                     <div class="form-group">
                        <label>PCMH NPI ID <span style="color:red;">*</span></label>
                        <input type="text" name="pcmh_npi_id" id="pcmh_npi_id"  class="form-control" placeholder="PCMH NPI ID" ng-model="pcmh.pcmh_npi_id" required>
                        <span class="error" ng-show="form.pcmh_npi_id.$dirty && form.pcmh_npi_id.$error.required">Enter Your PCMH NPI ID!.</span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>PCMH Tax ID <span style="color:red;">*</span></label>
                        <input type="text" name="pcmh_tax_id" id="pcmh_tax_id"  class="form-control" placeholder="PCMH Tax ID" ng-model="pcmh.pcmh_tax_id" required>
                        <span class="error" ng-show="form.pcmh_tax_id.$dirty && form.pcmh_tax_id.$error.required">Enter Your PCMH Tax ID!.</span>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-6">
                     <div class="form-group">
                        <label>PCMH Designated User name <span style="color:red;">*</span></label>
                        <input type="text" name="pcmh_deignated_user_name" id="pcmh_deignated_user_name"  class="form-control" placeholder="PCMH Designated User name" ng-model="pcmh.pcmh_deignated_user_name" required>
                        <span class="error" ng-show="form.pcmh_deignated_user_name.$dirty && form.pcmh_deignated_user_name.$error.required">Enter Your PCMH Designated User name!.</span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>First Name <span style="color:red;">*</span></label>
                        <input type="text" name="firstname" id="firstname"  class="form-control" placeholder="First Name" ng-model="pcmh.firstname" required>
                        <span class="error" ng-show="form.firstname.$dirty && form.firstname.$error.required">Enter Your First Name!.</span>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Last Name <span style="color:red;">*</span></label>
                        <input type="text" name="lastname" id="lastname"  class="form-control" placeholder="Last Name" ng-model="pcmh.lastname" required>
                        <span class="error" ng-show="form.lastname.$dirty && form.lastname.$error.required">Enter Your Last Name!.</span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Email ID<span style="color:red;">*</span></label>
                        <input type="email" name="email_id" id="email_id"  class="form-control" placeholder="Email" ng-model="pcmh.email_id" readonly required>
                        <span class="error" ng-show="form.email_id.$dirty && form.email_id.$error.required">Enter Your Email ID!.</span>
                        <span class="error" ng-show="form.email_id.$dirty && form.email_id.$error.email">Enter Your Valid Email ID!.</span>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="row">
                    <div class="col-md-6">
                       <div class="form-group">
                        <label>PCMH User ID <span style="color:red;">*</span></label>
                        <input type="text" name="pcmh_user_id" id="pcmh_user_id"  class="form-control" placeholder="PCMH User ID" ng-model="pcmh.pcmh_user_id" readonly required>
                        <span class="error" ng-show="form.pcmh_user_id.$dirty && form.pcmh_user_id.$error.required">Enter PCMH User ID!.</span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="exampleInputPassword1">PCMH Password <span style="color:red;">*</span></label>
                        <input type="password" class="form-control" id="password" name="password" placeholder="PCMH Password" ng-model="pcmh.password">
                       </div>
                    </div>
                  </div> -->

                  <br>
                  <div class="row">
                    
                    <div class="col-md-12" style="text-align: center;">
                      <input type="submit" id="submit" name="submit" class="btn btn-primary" value="Update">
                    </div>
                  </div>
                  <br>
                </div>
                <!-- /.card-body -->

                
              </form>


<br><br>
              

              
            </div>
            <!-- /.card -->
          </div>
        </div>

        
        <!-- /.row -->
      </div><!-- /.container-fluid -->
    </section>
  </div>
  <script src="../dist/js/angular.min.js"></script>
  <script type="text/javascript">
   
    $(document).ready(function () {
      bsCustomFileInput.init();
      const pcmhid =  sessionStorage.getItem("edited_pcmhid");
      sessionStorage.setItem("pagename", "updatepcmh");
      
      GetPCMHData(pcmhid);
      var usertype=sessionStorage.getItem("usertype");
      var username=sessionStorage.getItem("username");
    
      document.getElementById('usertype').innerHTML=usertype;
      document.getElementById('username').innerHTML=username;
    });
  

  function GetPCMHData(pcmhid)
  {
   console.log("GetPCMHData");
    document.getElementById("loader").style.display = "block";  
    var data='{"pcmhid":'+pcmhid+'}';
  
    fetch("https://apimsdcm.azure-api.net/dcmAPIM/PCMHData", {
          method: 'POST',
        // mode: 'no-cors', // no-cors, *cors, same-origin

        headers: { 'Content-Type': 'application/json;charset=utf-8',
              "x-functions-key": "Y75v69weCc0+ZanTjf0jSihLRlZAOUJGRM8xTAbdDLMZdQiXYNiJfg==",
              "Ocp-Apim-Subscription-Key": "2584a9c08dd04aa49db05cbb265c9b91",
              // "subscription-key":"da91fd77-c908-4f23-9469-52acf3239a11"
              },
          body: data
          
      }).then((response) => {
        
                      if (response.ok) {
                        
                      return response
                      
                  } else {

                      throw `update Looks like something went wrong. Status: ${response}`;
                  }
              })
              .then(response => response.json())
              .then(data => {
                  console.log("update data data: [" + JSON.stringify(data)+"]")
                  document.getElementById('pcmhid').value = data.pcmhid;
                  document.getElementById('pcmh_name').value = data.pcmhname;
                  document.getElementById('pcmh_site_name').value = data.pcmhsitename;
                  document.getElementById('pcmh_npi_id').value = data.pcmhNPI_ID;
                  document.getElementById('pcmh_tax_id').value = data.pcmhTax_ID;
                  document.getElementById('pcmh_deignated_user_name').value = data.pcmh_dgn_username;
                  document.getElementById('firstname').value = data.firstname;
                  document.getElementById('lastname').value = data.lastname;
                  document.getElementById('email_id').value = data.emailID;
                  document.getElementById("loader").style.display = "none";
                 // document.getElementById('pcmh_user_id').value = data.pcmhuserid;
                  
                
                })
                .catch(error => {
                  document.getElementById("loader").style.display = "none";
                  console.log(error)
               })  
      //End : Get PCMH Data by using PCMHID
  }

  //Start : Generate Json

  
 
  $.fn.serializeObject = function()
  {
      var o = {};
      var a = this.serializeArray();
    
      $.each(a, function() {
          if (o[this.name] !== undefined) {
              if (!o[this.name].push) {
                  o[this.name] = [o[this.name]];
              }
              o[this.name].push(this.value || '');
          } else {
              o[this.name] = this.value || '';
          }
      });

      
      return o;
  };

  var app = angular.module('addpcmh', []);

  app.controller('addpcmhController', function($scope) 
  {


      $scope.submitForm = function () {
      document.getElementById("loader").style.display = "block";
        var result = JSON.stringify($('form').serializeObject());
        $('#result').text(JSON.stringify($('form').serializeObject()));

        fetch("https://apimsdcm.azure-api.net/dcmAPIM/UpdatePCMH", {
        method: 'post',
       // mode: 'no-cors', // no-cors, *cors, same-origin

          headers: { 'Content-Type': 'application/json',
            "x-functions-key": "Y75v69weCc0+ZanTjf0jSihLRlZAOUJGRM8xTAbdDLMZdQiXYNiJfg==",
            "Ocp-Apim-Subscription-Key": "2584a9c08dd04aa49db05cbb265c9b91",
            // "subscription-key":"da91fd77-c908-4f23-9469-52acf3239a11"
            },
        body: result
      }).then((response) => {

     
      // updatedata(jsonData);

                if (response.ok) {
                    toastr.success('PCMH Update Successfully!.');
                } else {
                  toastr.error('Erro in Updating PCMH!.');
                }
                document.getElementById("loader").style.display = "none";
                setTimeout(function() {
                  loadPcmhpage();
                // window.location.replace("PCMH.html");
                },2000);
            })
            .catch(error => {
                console.log("Errroorrr "+error)
            })  
        

    };
   
    
  });


  </script>
   
    
